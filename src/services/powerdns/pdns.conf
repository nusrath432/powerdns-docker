# PowerDNS Authoritative Server Configuration

# General
daemon=no
guardian=yes
setuid=pdns
setgid=pdns
config-dir=/etc/powerdns

# Logging
loglevel=3
log-dns-details=yes
log-dns-queries=yes
disable-syslog=no
logging-facility=0

# Performance
distributor-threads=1
receiver-threads=30
reuseport=yes

# DNS service
local-address=0.0.0.0
local-port=53
version-string=anonymous
expand-alias=yes
disable-axfr=yes
disable-axfr-rectify=yes
allow-axfr-ips=127.0.0.1

# SOA defaults
default-ttl=3600
default-soa-content=ns1.cloud.site.sa hostmaster.cloud.site.sa 0 10800 3600 604800 600
default-soa-edit=INCEPTION-EPOCH
default-soa-edit-signed=INCEPTION-EPOCH

# API / Webserver
api=yes
api-key=${PDNS_AUTH_API_KEY}
webserver=yes
webserver-address=0.0.0.0
webserver-port=8081
webserver-allow-from=0.0.0.0/0

# Backend (LMDB)
launch=lmdb
lmdb-shards=1
lmdb-filename=/var/lib/powerdns/pdns.lmdb
lmdb-schema-version=5
lmdb-sync-mode=sync
lmdb-lightning-stream=yes
lmdb-map-size=1024

# Lua records
enable-lua-records=yes
lua-records-insert-whitespace=no

# DNSSEC Configuration
dnssec=yes
default-ksk-algorithm=ecdsa256
default-zsk-algorithm=ecdsa256
default-ksk-size=0
default-zsk-size=0

# DNSSEC key rollover settings
auto-dnssec=on
nsec3-narrow=yes
default-negative-ttl=600

# DNSSEC timing
signature-inception-offset=300
signature-validity-default=604800
signature-cache-validity=86400

# Metrics / health (optional)
carbon-server=
carbon-interval=60
