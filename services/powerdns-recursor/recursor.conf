# PowerDNS Recursor 4.9 Configuration
# Process management
daemon=no
processes=1
threads=2

# NETWORK CONFIGURATION
local-address=0.0.0.0
local-port=53

# Access control
allow-from=127.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# Socket configuration
socket-dir=/var/run/pdns-recursor

# DNSSEC CONFIGURATION
dnssec=validate
dnssec-log-bogus=no

# Trust anchors (PowerDNS Recursor 4.9+ includes built-in current root keys)
# For custom trust anchors, uncomment and modify:
# trust-anchors=. IN DS 20326 8 2 E06D44B80B8F1D39A95C0B0D7C65D08458E880409BBC683457104237C7F8EC8D

# DNSSEC validation settings
max-signature-validations-per-query=30
max-nsec3-hash-computations-per-query=600
max-dnskeys=2
max-ds-per-zone=8

# Cache settings
max-cache-entries=1000000
max-negative-ttl=3600
max-cache-ttl=86400
max-packetcache-entries=500000
packetcache-ttl=86400

# Performance settings
max-mthreads=2048
max-tcp-clients=128
max-tcp-per-client=0
max-tcp-queries-per-connection=0

# Network timeout
network-timeout=1500

# Recursion limits
max-qperq=60
max-total-msec=7000
max-recursion-depth=16

# Query minimization
qname-minimization=yes

# Forward zones (empty by default)
forward-zones=
forward-zones-file=
forward-zones-recurse=

# Authority zones
auth-zones=

# Spoof detection
spoof-nearmiss-max=1

# Query restrictions
dont-query=127.0.0.0/8, 10.0.0.0/8, 100.64.0.0/10, 169.254.0.0/16, 192.168.0.0/16, 172.16.0.0/12, ::1/128, fc00::/7, fe80::/10, 0.0.0.0/8, 192.0.0.0/24, 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, 240.0.0.0/4, ::/96, ::ffff:0:0/96, 100::/64, 2001:db8::/32

# Web server settings
webserver=yes
webserver-address=0.0.0.0
webserver-port=8082
webserver-allow-from=127.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
webserver-loglevel=normal

# API settings
api-key=${PDNS_RECURSOR_API_KEY}

# Basic logging
loglevel=3
quiet=no
log-timestamp=yes

# Disable syslog in Docker
disable-syslog=yes

# Statistics
statistics-interval=1800
stats-ringbuffer-entries=10000

# ECS (EDNS Client Subnet)
ecs-add-for=0.0.0.0/0, ::/0, !127.0.0.0/8, !10.0.0.0/8, !100.64.0.0/10, !169.254.0.0/16, !192.168.0.0/16, !172.16.0.0/12, !::1/128, !fc00::/7, !fe80::/10
ecs-ipv4-bits=24
ecs-ipv6-bits=56

# Lua scripting
lua-config-file=
lua-dns-script=

# Various operational settings
root-nx-trust=yes
serve-rfc1918=yes
reuseport=yes

hint-file=

export-etc-hosts=off

# Version information
version-string=PowerDNS Recursor
